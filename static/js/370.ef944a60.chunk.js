!function(){"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,n){return r=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},r(t,n)}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function o(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,n){if(n&&("object"===a(n)||"function"===typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function c(t,n){if(t){if("string"===typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}function f(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"iid";return t.map((function(t,e){return t[n]=e,t}))}function h(t,n){n=Math.min(t-n,n);for(var e=1,r=1;r<=n;r++)e*=t-n+r,e/=r;return e}var d=function(){function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random;t(this,n),this.k=void 0,this.randFn=void 0,this.r=void 0,this.i=void 0,this.finished=void 0,this.k=e,this.randFn=r,this.r=[],this.i=0,this.finished=!1}return e(n,[{key:"next",value:function(t){if(this.finished&&console.log("warning: call next after finalSample"),"undefined"!==typeof t){if(this.r.length<this.k)this.r.push(t);else{var n=Math.floor(this.randFn()*(this.i+1));n<this.k&&(this.r[n]=t)}this.i+=1}}},{key:"sample",value:function(){return this.r}},{key:"finalSample",value:function(){return function(t){for(var n=t.length-1;n>0;n--){var e=Math.floor(Math.random()*(n+1)),r=[t[e],t[n]];t[n]=r[0],t[e]=r[1]}}(this.r),this.finished=!0,this.r}}]),n}();var v=function(){function n(e){t(this,n),this.data=void 0,this.data=e.toString()}return e(n,[{key:"deserialize",value:function(){return Function("'use strict'; return (".concat(this.data,")"))()}}],[{key:"deserialize",value:function(t){return Function("'use strict'; return (".concat(t.data,")"))()}}]),n}(),p=function(){function n(e){t(this,n),this.request=void 0,this.validateFn=void 0,this.sampler=void 0,this.count=void 0,this.request=e,this.validateFn=v.deserialize(e.validateFn)(),this.sampler=new d(e.numDecks),this.count=0}return e(n,[{key:"finalize",value:function(){return new m(this.request,this.sampler.finalSample(),this.count)}}]),n}(),m=e((function n(e,r,i){t(this,n),this.request=void 0,this.result=void 0,this.count=void 0,this.request=e,this.result=r,this.count=i})),y=e((function n(e,r,i){t(this,n),this.faction=void 0,this.commandar=void 0,this.units=void 0,this.faction=e,this.commandar=r,this.units=i})),g={Infantry:0,Vehicle:1,Air:2,Tech:3,Commandar:4},b=function(t,n){return g[t.building]!==g[n.building]?g[t.building]-g[n.building]:t.cost!==n.cost?t.cost-n.cost:t.name>n.name?1:-1},E=function(){function n(e,r){t(this,n),this.units=void 0,this.commandars=void 0,this.size=void 0,this.unitsReverseMap=void 0,this.commandarsReverseMap=void 0,this.units=l(e.sort(b)),this.commandars=l(r),this.size=h(e.length,6)*r.length;var i=new Map;e.forEach((function(t,n){return i.set(t.name,n)})),this.unitsReverseMap=i,i=new Map,r.forEach((function(t,n){return i.set(t.name,n)})),this.commandarsReverseMap=i}return e(n,[{key:"get",value:function(t){var n=this;if(t<0||t>=this.size)throw new Error("index out of bound: ".concat(t," is not in range [0, ").concat(this.size,")"));var e=Math.floor(t/this.commandars.length),r=t%this.commandars.length,i=function(t,n,e){for(var r=[],i=0;i<t+1;i++){var o=h(t-i-1,n-1);if(e<o){if(r.push(i),(n-=1)<=0)break}else e-=o}return r}(this.units.length,6,e).map((function(t){return n.units[t]})),o=this.commandars[r];return new y(o.faction,o,i)}},{key:"getIndex",value:function(t){var n=this,e=t.units.map((function(t){return n.unitsReverseMap.get(t.name)})).filter((function(t){return void 0!==typeof t})),r=this.commandarsReverseMap.get(t.commandar.name);if(6!==e.length||void 0===r)throw new Error("invalid deck or not part of this database");return function(t,n){var e=t.length;n-=1;for(var r=0,i=0,o=0;o<e;o++){for(var a=o+1,u=t[o];i<u;)r+=h(n-i,e-a),i+=1;i+=1}return r}(e,this.units.length)*this.commandars.length+r}}]),n}(),w=function(){function n(e){t(this,n),this.units=void 0,this.commandars=void 0,this.size=void 0,this.dbs=void 0,this.dbs=e;var r=e.reduce((function(t,n){return t+=n.size}),0);this.size=r;var i=[];i.concat.apply(i,f(this.dbs.map((function(t){return t.units})))),this.units=i;var o=[];o.concat.apply(o,f(this.dbs.map((function(t){return t.commandars})))),this.commandars=o}return e(n,[{key:"get",value:function(t){if(t<0||t>=this.size)throw new Error("index out of bound");for(var n=0;t>=this.dbs[n].size;)t-=this.dbs[n].size,n+=1;return this.dbs[n].get(t)}},{key:"getIndex",value:function(t){throw new Error("operation not supported")}}]),n}(),S=function(n){!function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&r(t,n)}(s,n);var a=function(t){var n=o();return function(){var e,r=i(t);if(n){var o=i(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return u(this,e)}}(s);function s(n,e,r,i){var o;return t(this,s),(o=a.call(this)).GDI_DECKS=void 0,o.NOD_DECKS=void 0,o.ALL_DECKS=void 0,o.GDI_DECKS=new E(n,e),o.NOD_DECKS=new E(r,i),o.ALL_DECKS=new w([o.GDI_DECKS,o.NOD_DECKS]),o}return e(s,[{key:"generate",value:function(t){var n=new Map;t.forEach((function(t,e){n.set(t,e)}));var e=t.filter((function(t){return"GDI"===t.faction})),r=t.filter((function(t){return"Nod"===t.faction})),i=t.filter((function(t){return"random"===t.faction})),o=this.generateCustom(e,this.GDI_DECKS),a=this.generateCustom(r,this.NOD_DECKS),u=this.generateCustom(i,this.ALL_DECKS),s=[];return o.forEach((function(t){s[n.get(t.request)]=t})),a.forEach((function(t){s[n.get(t.request)]=t})),u.forEach((function(t){s[n.get(t.request)]=t})),s}},{key:"generateAsync",value:function(t,n){n(this.generate(t))}},{key:"getDeckId",value:function(t){var n="GDI"===t.faction?"gdi":"nod",e="GDI"===t.faction?this.GDI_DECKS.getIndex(t):this.NOD_DECKS.getIndex(t);return"".concat(n,"-").concat(e)}},{key:"getDeck",value:function(t){var n=/^(gdi|nod)-([0-9]+)$/i.exec(t);if(null===n)throw new Error("invalid deckID");var e=n[1],r=parseInt(n[2]);return"gdi"===e?this.GDI_DECKS.get(r):this.NOD_DECKS.get(r)}}]),s}(function(){function n(){t(this,n)}return e(n,[{key:"generateCustom",value:function(t,n){if(t.length>0){for(var e=t.map((function(t){return new p(t)})),r=function(t){var r=n.get(t);e.forEach((function(t){t.validateFn(r)&&(t.sampler.next(r),t.count+=1)}))},i=0;i<n.size;i++)r(i);return e.map((function(t){return t.finalize()}))}return[]}},{key:"generate",value:function(t){throw console.log("cannot call generate() on abstractDeckGenerator"),new Error("cannot call generate() on abstractDeckGenerator")}}]),n}());function k(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(s){u=!0,i=s}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}}(t,n)||c(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function C(t,n,e){return C=o()?Reflect.construct:function(t,n,e){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(t,i));return e&&r(o,e.prototype),o},C.apply(null,arguments)}var O=Symbol("Comlink.proxy"),A=Symbol("Comlink.endpoint"),I=Symbol("Comlink.releaseProxy"),M=Symbol("Comlink.thrown"),_=function(t){return"object"===typeof t&&null!==t||"function"===typeof t},j=new Map([["proxy",{canHandle:function(t){return _(t)&&t[O]},serialize:function(t){var n=new MessageChannel,e=n.port1,r=n.port2;return R(t,e),[r,[r]]},deserialize:function(t){return t.start(),L(t,[],n);var n}}],["throw",{canHandle:function(t){return _(t)&&M in t},serialize:function(t){var n=t.value;return[n instanceof Error?{isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:{isError:!1,value:n},[]]},deserialize:function(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function R(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;n.addEventListener("message",(function e(r){if(r&&r.data){var i,o=Object.assign({path:[]},r.data),a=o.id,u=o.type,s=o.path,c=(r.data.argumentList||[]).map(F);try{var l=s.slice(0,-1).reduce((function(t,n){return t[n]}),t),h=s.reduce((function(t,n){return t[n]}),t);switch(u){case"GET":i=h;break;case"SET":l[s.slice(-1)[0]]=F(r.data.value),i=!0;break;case"APPLY":i=h.apply(l,c);break;case"CONSTRUCT":var d;i=K(C(h,f(c)));break;case"ENDPOINT":var v=new MessageChannel,p=v.port1,m=v.port2;R(t,m),i=N(p,[p]);break;case"RELEASE":i=void 0;break;default:return}}catch(d){i=D({value:d},M,0)}Promise.resolve(i).catch((function(t){return D({value:t},M,0)})).then((function(t){var r=k(G(t),2),i=r[0],o=r[1];n.postMessage(Object.assign(Object.assign({},i),{id:a}),o),"RELEASE"===u&&(n.removeEventListener("message",e),z(n))}))}})),n.start&&n.start()}function z(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function P(t){if(t)throw new Error("Proxy has been released and is not useable")}function L(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=!1,i=new Proxy(e,{get:function(e,o){if(P(r),o===I)return function(){return q(t,{type:"RELEASE",path:n.map((function(t){return t.toString()}))}).then((function(){z(t),r=!0}))};if("then"===o){if(0===n.length)return{then:function(){return i}};var a=q(t,{type:"GET",path:n.map((function(t){return t.toString()}))}).then(F);return a.then.bind(a)}return L(t,[].concat(f(n),[o]))},set:function(e,i,o){P(r);var a=k(G(o),2),u=a[0],s=a[1];return q(t,{type:"SET",path:[].concat(f(n),[i]).map((function(t){return t.toString()})),value:u},s).then(F)},apply:function(e,i,o){P(r);var a=n[n.length-1];if(a===A)return q(t,{type:"ENDPOINT"}).then(F);if("bind"===a)return L(t,n.slice(0,-1));var u=k(x(o),2),s=u[0],c=u[1];return q(t,{type:"APPLY",path:n.map((function(t){return t.toString()})),argumentList:s},c).then(F)},construct:function(e,i){P(r);var o=k(x(i),2),a=o[0],u=o[1];return q(t,{type:"CONSTRUCT",path:n.map((function(t){return t.toString()})),argumentList:a},u).then(F)}});return i}function x(t){var n,e=t.map(G);return[e.map((function(t){return t[0]})),(n=e.map((function(t){return t[1]})),Array.prototype.concat.apply([],n))]}var T=new WeakMap;function N(t,n){return T.set(t,n),t}function K(t){return Object.assign(t,D({},O,!0))}function G(t){var n,e=function(t,n){var e="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=c(t))||n&&t&&"number"===typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}(j);try{for(e.s();!(n=e.n()).done;){var r=k(n.value,2),i=r[0],o=r[1];if(o.canHandle(t)){var a=k(o.serialize(t),2);return[{type:"HANDLER",name:i,value:a[0]},a[1]]}}}catch(u){e.e(u)}finally{e.f()}return[{type:"RAW",value:t},T.get(t)||[]]}function F(t){switch(t.type){case"HANDLER":return j.get(t.name).deserialize(t.value);case"RAW":return t.value}}function q(t,n,e){return new Promise((function(r){var i=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");t.addEventListener("message",(function n(e){e.data&&e.data.id&&e.data.id===i&&(t.removeEventListener("message",n),r(e.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:i},n),e)}))}R(S)}();
//# sourceMappingURL=370.ef944a60.chunk.js.map